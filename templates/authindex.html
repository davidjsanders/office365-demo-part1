{% extends "layout.html" %}
{% block body %}
    <h2>Connecting to Office 365 Services</h2>
    <p>
        Step 2. The application has now been authenticated. An access token for Office 365 now
        has to be created from the data below.
    </p>
    <p>Page is {{ method }} mode.</p>
    <table id="contacts" width="99%" border="1" style="word-wrap: break-word;">
        <tr>
            <th>Form Item</th>
            <th>Value</th>
        </tr>
        {% for key, value in form_data.items() %}
            <tr>
                <td>{{ key}}</td>
                <td>{{ value }}</td>
            </tr>
        {% endfor %}
    </table>
    <p>Step 2. Get a token to connect to Office 365 based on the authorization:
        <a href="{{ auth_source }}">Generate the token</a>
    </p>
{% endblock %}